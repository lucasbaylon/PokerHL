<div class="header">
    <ion-button class="backArrow" (click)="redirectTo('manage')">
        <ion-icon name="arrow-back-outline"></ion-icon>
    </ion-button>
    <div class="inner-header">
        <h1 *ngIf="mode === 'new'">Enregistrer une nouvelle situation</h1>
        <h1 *ngIf="mode === 'edit'">Modifier la situation</h1>
        <div class="div-input-text field">
            <input [(ngModel)]="situationName" type="text" class="styled-input-text" placeholder="Nom de la situation"
                name="situationName" id='situationName' autocomplete="off" />
            <label for="situationName" class="styled-input-text-label">Nom de la situation</label>
        </div>
    </div>
    <div class="case-definition">
        <table>
            <tbody>
                <tr *ngFor="let row of situation_obj.situations">
                    <td *ngFor="let item of row" (mousedown)="startSelection($event)"
                        (mouseenter)="updateSelection($event)" (mouseup)="endSelection()"
                        [style.background]="(item.action! | actionColor)">
                        {{item.card}}</td>
                </tr>
            </tbody>
        </table>
        <div class="solutions">
            <h2 class="firsth2">Solutions</h2>
            <ng-container *ngFor="let action of situation_obj.actions; let i = index">
                <div class="solution-selector">
                    <input type="input" class="textInput" value="{{action.display_name}}" [id]="action.id"
                        (input)="onChangeActionName(action.id, $event)" placeholder="Aucun" autocomplete="off" />
                    <div class="color-picker-square" (click)="test(i)"></div>
                </div>
                <!-- <div class="color-picker-div color-picker-div-closed"  [id]="'color-picker-div_' + i">
                        <div class="colors">
                            <div class="color-picker-square" style="background: #d80c05"></div>
                            <div class="color-picker-square" style="background: #ff9100"></div>
                            <div class="color-picker-square" style="background: #ebe700"></div>
                            <div class="color-picker-square" style="background: #3f7a89"></div>
                            <div class="color-picker-square" style="background: #96c582"></div>
                            <div class="color-picker-square" style="background: #303030"></div>
                            <div class="color-picker-square" style="background: #1c51ff"></div>
                            <div class="color-picker-square" style="background: #00aeff"></div>
                            <div class="color-picker-square" style="background: #8400ff"></div>
                            <div class="color-picker-square" style="background: #e284ff"></div>
                        </div>
                        <div class="hex-code">
                            <div class="g-input">
                                <input type="text" value="#ffffff" />
                            </div>
                        </div>
                    </div> -->
            </ng-container>
            <button class="fill addButton" (click)="addAction()">Ajouter +</button>
        </div>
        <div class="mixed-solutions-div">
            <h2 class="firsth2">Fréquences de solutions</h2>
            <div *ngFor="let mixed-solution of mixedSolutionsList" class="table-row mixed-solution">
                <div class="mixed-solution-name">
                    All In + Call
                </div>
                <ion-button class="col-2">
                    <ion-icon name="pencil-outline"></ion-icon>
                </ion-button>
                <ion-button class="col-3">
                    <ion-icon name="trash-outline"></ion-icon>
                </ion-button>
            </div>
            <button class="fill addButton">Ajouter +</button>
            <div class="add-mixed-solution">
                <h2 class="firsth2">Ajouter des fréquences de solutions</h2>
                <ng-container *ngFor="let action of situation_obj.actions; let i = index">
                    <div class="solution-selector">{{action.display_name}}<div class="color-picker-square"></div>
                    </div>
                </ng-container>
            </div>
        </div>
    </div>
    <div class="situationCaracteristics">
        <h2 class="firsth2">Combien de BB reste t-il au dealer ?</h2>
        <div class="div-input-text field input-nb-bb-restants">
            <input type="number" min="1" step="1" class="styled-input-text" id="jetonsRestants" name="jetonsRestants"
                placeholder="Nombre de jetons restants" [(ngModel)]="dealerMissingTokens" />
            <label for="jetonsRestants" class="styled-input-text-label">Nombre de BB restantes</label>
        </div>
        <h2 class="middleh2">Combien de joueurs y a-t-il autour de la table ?</h2>
        <div>
            <button id="btn2Player" class="fill smallButton" (click)="onChangeNBPlayer(2)">2</button>
            <button id="btn3Player" class="fill smallButton selectedButton" (click)="onChangeNBPlayer(3)">3</button>
        </div>
        <h2 class="lasth2">Quel joueur autour de la table est le dealer ?</h2>
        <div>
            <button id="btnYouDealer" class="fill smallButton selectedButton"
                (click)="onChangeDealer('you')">Vous</button>
            <button id="btnOpponent1Dealer" class="fill smallButton" (click)="onChangeDealer('opponent1')">Adversaire
                1</button>
            <button *ngIf="showOpponent2" id="btnOpponent2Dealer" class="fill smallButton"
                (click)="onChangeDealer('opponent2')">Adversaire
                2</button>
        </div>
        <h2 class="lasth2">Quel niveau ont les adversaires ?</h2>
        <div>
            <button id="btnFishOpponent" class="fill smallButton selectedButton"
                (click)="onChangeOpponentLevel('fish')">Débutant</button>
            <button id="btnSharkOpponent" class="fill smallButton"
                (click)="onChangeOpponentLevel('shark')">Confirmé</button>
        </div>
    </div>
    <button class="fill saveButton" (click)="saveSituation()">Enregistrer</button>
    <div>
        <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
            <defs>
                <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
            </defs>
            <g class="parallax">
                <use xlink:href="#gentle-wave" x="48" y="0" fill="rgba(255,255,255,0.7)" />
                <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(255,255,255,0.5)" />
                <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(255,255,255,0.3)" />
                <use xlink:href="#gentle-wave" x="48" y="7" fill="#fff" />
            </g>
        </svg>
    </div>
</div>